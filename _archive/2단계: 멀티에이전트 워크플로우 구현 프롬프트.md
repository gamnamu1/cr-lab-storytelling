# 멀티에이전트 소설 창작 워크플로우 구현

## 사전 조건
`agents/` 디렉토리에 다음 파일들이 준비되어 있습니다:
- `00-orchestration.md` (전체 조율 가이드)
- `01-philosopher.md` ~ `05-literary-critic.md` (에이전트별 지침서)

---

## 구현 요청

### 1. 워크플로우 스크립트 생성

`workflow/run.py` 파일을 만들어주세요:
```python
# 핵심 구조 예시
class NovelWorkflow:
    def __init__(self, agents_dir: str):
        self.agents = self.load_agents(agents_dir)
        self.orchestration = self.load_orchestration(agents_dir)
    
    def load_agent(self, agent_name: str) -> str:
        """에이전트 지침서를 로드하여 시스템 프롬프트로 반환"""
        pass
    
    def run_agent(self, agent_name: str, input_text: str, context: dict) -> str:
        """특정 에이전트로서 작업 수행"""
        pass
    
    def run_pipeline(self, user_input: str, checkpoints: bool = True):
        """전체 파이프라인 실행, 체크포인트에서 사용자 확인"""
        pass
```

**포함 기능**:
- 각 단계를 함수로 모듈화
- 단계별 중간 산출물을 `workflow/outputs/`에 저장
- 각 단계에서 해당 에이전트 지침서를 시스템 프롬프트로 로드
- 진행 상황 로깅
- 체크포인트에서 사용자 입력 대기 (선택적)

### 2. 산출물 구조
```
workflow/
├── run.py                    # 메인 실행 스크립트
├── agents/                   # 에이전트 지침서 (1단계에서 생성)
│   ├── 00-orchestration.md
│   ├── 01-philosopher.md
│   ├── 02-novelist-creator.md
│   ├── 03-novelist-critic.md
│   ├── 04-editor.md
│   └── 05-literary-critic.md
├── outputs/                  # 단계별 산출물
│   ├── 01-theme.md
│   ├── 02-synopsis_v1.md
│   ├── 03-feedback.md
│   ├── 04-draft_v1.md
│   ├── 05-edit_notes.md
│   ├── 06-draft_v2.md
│   ├── 07-critique.md
│   └── 08-final.md
└── logs/                     # 실행 로그
    └── session_YYYYMMDD_HHMMSS.log
```

### 3. 실행 모드

**모드 A: 대화형 (체크포인트 활성화)**
```bash
python run.py --input "소재.txt" --interactive
```
- Step 3, Step 5 완료 후 사용자 확인 대기
- 사용자가 "진행", "수정", "중단" 선택 가능

**모드 B: 자동 (체크포인트 비활성화)**
```bash
python run.py --input "소재.txt" --auto
```
- 전체 파이프라인 자동 실행
- 모든 중간 산출물 저장

### 4. 테스트 실행

간단한 입력으로 전체 파이프라인 테스트:
- 샘플 입력: 짧은 시나 문장 (3-5줄)
- 각 단계의 출력이 다음 단계로 올바르게 전달되는지 확인
- 최종 산출물까지 도달 여부 검증

### 5. 에이전트 호출 시 출처 표기

각 에이전트가 작업할 때, 지침서의 기법을 적용한 경우 출처를 각주처럼 표기하도록 프롬프트에 포함:
```
당신의 판단이나 제안에 참고한 기법이 있다면, 
다음 형식으로 근거를 명시하세요: [서적ID: 개념명]
```

---

## 추가 고려사항

### 에러 처리
- API 호출 실패 시 재시도 로직
- 중간 저장으로 작업 복구 가능

### 확장성
- 새로운 에이전트 추가 용이한 구조
- 지침서만 추가하면 파이프라인에 통합 가능

---

먼저 구현 방식에 대한 계획을 공유해주세요.
