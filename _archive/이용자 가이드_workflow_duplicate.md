# 멀티에이전트 소설 창작 시스템 - 이용자 가이드

---

## 목차

1. [시스템 개요](#1-시스템-개요)
2. [시작하기 전 준비사항](#2-시작하기-전-준비사항)
3. [새 소설 작성하기](#3-새-소설-작성하기)
4. [기존 소설 수정하기](#4-기존-소설-수정하기)
5. [도메인 지식 활용하기](#5-도메인-지식-활용하기)
6. [프로세스 상세 설명](#6-프로세스-상세-설명)
7. [세션 종료 후 재시작](#7-세션-종료-후-재시작)
8. [문제 해결](#8-문제-해결)

---

## 1. 시스템 개요

이 시스템은 **7명의 AI 에이전트**가 협력하여 소설을 창작합니다.

### 에이전트 구성

| 에이전트 | 역할 | 핵심 업무 |
|---------|------|----------|
| **리서처** | 도메인 전문가 | 페르소나 기반 전문 지식 제공 (LLM 내재 지식 활용) |
| **철학자** | 화두 발굴자 | 소재에서 본질적 질문과 주제의식 도출 |
| **소설가 A** | 작가 | 시놉시스 설계, 본문 작성, 수정 반영 |
| **소설가 B** | 구조 비평가 | 시놉시스의 구조적 완결성 비평 |
| **편집자** | 문장 다듬기 | 문체, 리듬, 가독성 개선 |
| **비평가** | 문학 해석가 | 작품의 문학적 의의와 승화 방향 제시 |
| **진단자** | 피드백 분석가 | 독자 피드백 분석, 수정 계획 수립 |

### 실행 모드

| 모드 | 용도 | 언제 사용? |
|------|------|-----------|
| **기본 모드** | 일반 소설 창작 | 특별한 전문 지식 없이 소설 작성 |
| **도메인 학습 모드** | 전문 분야 소설 | 언론, 의료, 법조 등 특정 분야 배경 소설 |
| **재작성 모드** | 완성본 수정 | 피드백 반영하여 기존 소설 개선 |

---

## 2. 시작하기 전 준비사항

### 필수 요구사항

```bash
# Python 3.8 이상
python3 --version

# anthropic 라이브러리 설치
pip install anthropic

# API 키 설정
export ANTHROPIC_API_KEY="your-api-key-here"
```

### 프로젝트 위치

```
/Users/gamnamu/Documents/cr-lab-stroytelling/workflow/
```

### 디렉토리 구조

```
workflow/
├── run.py                  ← 메인 실행 스크립트
├── agents/                 ← 에이전트 지침서
│   ├── 00-orchestration.md
│   ├── 00-researcher.md
│   ├── 00-diagnostician.md
│   ├── 01-philosopher.md
│   ├── 02-novelist-creator.md
│   ├── 03-novelist-critic.md
│   ├── 04-editor.md
│   └── 05-literary-critic.md
├── references/             ← 도메인 자료 저장소
│   ├── journalism/
│   ├── medicine/
│   └── law/
├── outputs/                ← 결과물 저장 위치
└── logs/                   ← 실행 로그
```

---

## 3. 새 소설 작성하기

### Step 1: 소재 파일 작성

**저장 위치**: `workflow/` 폴더에 `.txt` 파일로 저장

**파일명 예시**: `소재_가족이야기.txt`, `material_01.txt`

### 좋은 소재 프롬프트 작성법

```markdown
# 핵심 상황/이미지
[이야기의 씨앗이 될 구체적인 상황이나 장면]

# 등장인물 힌트 (선택)
[주인공이나 핵심 인물에 대한 간단한 스케치]

# 배경/세계 (선택)
[시대, 공간, 분야 등]

# 탐구하고 싶은 질문 (선택)
[이 이야기를 통해 던지고 싶은 질문]
```

### 소재 예시

**좋은 소재** ✅:
```
비 오는 날, 할머니의 장례식장.
10년간 연락 없이 살던 세 형제가 모인다.
유품을 정리하다 발견한 할머니의 일기장.
거기엔 아무도 몰랐던 할머니의 첫사랑 이야기가 적혀 있었다.

형제들은 각자의 삶에서 도망쳐온 사람들이다.
첫째는 이혼 직전, 둘째는 사업 실패, 막내는 해외에서 돌아온 직후.

질문: 가족이란 무엇인가? 우리는 왜 가까운 사람에게 진실을 숨기는가?
```

**부족한 소재** ❌:
```
슬픈 이야기를 써줘.
가족 이야기.
감동적인 걸로.
```

### Step 2: 실행

```bash
cd /Users/gamnamu/Documents/cr-lab-stroytelling/workflow

# 대화형 모드 (체크포인트에서 확인 가능)
python run.py --input 소재_가족이야기.txt --interactive

# 자동 모드 (끝까지 자동 실행)
python run.py --input 소재_가족이야기.txt --auto

# 텍스트 직접 입력
python run.py --input-text "비 오는 장례식장에서 형제들이 만난다" --auto
```

### Step 3: 체크포인트에서 선택

대화형 모드에서는 중간중간 확인을 요청합니다:

```
============================================================
[체크포인트] Step 3 완료: 시놉시스 비평
============================================================

선택해주세요:
  1. 진행 (다음 단계로)
  2. 수정 (이전 단계 재실행)
  3. 중단 (현재까지 저장 후 종료)

선택 (1/2/3): _
```

### Step 4: 결과물 확인

완료 후 `outputs/` 폴더에서 결과물을 확인합니다:

```
outputs/
├── 01-theme.md           ← 화두/주제의식
├── 02-synopsis_v1.md     ← 시놉시스
├── 03-feedback.md        ← 구조 비평
├── 04-draft_v1.md        ← 본문 초고
├── 05-edit_notes.md      ← 편집 의견
├── 06-draft_v2.md        ← 수정된 본문
├── 07-critique.md        ← 문학적 해석
└── 08-final.md           ← ★ 최종 완성본
```

---

## 4. 기존 소설 수정하기

### Step 1: 원고 위치 확인

기존 완성본은 보통 다음 위치에 있습니다:
```
workflow/outputs/08-final.md
```

다른 위치의 파일도 경로를 지정하면 사용 가능합니다.

### Step 2: 피드백 작성

**좋은 피드백** ✅:
```
1. 결말이 너무 급하게 느껴져요. 주인공이 마음을 바꾸는 과정이
   충분히 설득력 있게 그려지지 않았어요.

2. 중반부 회상 장면이 너무 길어서 흐름이 끊겨요.

3. 막내 캐릭터가 평면적이에요. 왜 10년간 연락을 끊었는지
   동기가 약해요.

4. 전반적으로 문장이 딱딱하고 감정 묘사가 부족해요.

5. 할머니 일기장의 비밀이 너무 쉽게 밝혀져요.
   좀 더 긴장감 있게 전개되면 좋겠어요.
```

**부족한 피드백** ❌:
```
재미없어요.
다시 써주세요.
더 좋게 해주세요.
```

**피드백 작성 팁**:
- 어느 부분이 문제인지 **위치** 명시
- **왜** 그렇게 느꼈는지 설명
- 가능하면 **어떻게** 되었으면 좋겠는지 언급

### Step 3: 실행

```bash
cd /Users/gamnamu/Documents/cr-lab-stroytelling/workflow

# 피드백 직접 입력
python run.py --revise outputs/08-final.md --feedback "결말이 급해요. 주인공 변화가 설득력 없어요." --interactive

# 피드백 파일로 입력
python run.py --revise outputs/08-final.md --feedback-file feedback.txt --auto
```

### Step 4: 결과물 확인

```
outputs/
├── 08-final.md           ← 기존 완성본
├── R1-revision_plan.md   ← 수정 계획
├── R2-draft_revised.md   ← 수정된 본문
├── R3-edit_notes.md      ← 편집자 검토
└── revised_final.md      ← ★ 수정 완성본
```

### 반복 수정

수정 결과가 여전히 불만족스러우면 다시 실행:
```bash
python run.py --revise outputs/revised_final.md --feedback "추가 피드백" --auto
```

---

## 5. 도메인 지식 활용하기

특정 분야(언론, 의료, 법조 등)를 배경으로 한 소설을 쓸 때 활용합니다.

### 핵심 개념: 페르소나 기반 지식 활성화

이 시스템은 **LLM이 이미 보유한 방대한 세계 지식**을 활용합니다.
도메인 키워드를 입력하면, 리서처 에이전트가 해당 분야의 **15-20년 경력 베테랑 페르소나**로
전환되어 내부자만 아는 진실을 제공합니다.

**장점**:
- 외부 자료 준비 없이도 즉시 사용 가능
- 백과사전적 정보가 아닌 "현장의 진실" 제공
- 드라마가 될 수 있는 갈등과 딜레마 중심

### 등록된 도메인 목록

| 키워드 | 페르소나 | 경험 |
|--------|---------|------|
| `언론/탐사보도` | 탐사보도 기자 | 20년 |
| `언론/방송뉴스` | 방송기자 겸 앵커 | 18년 |
| `의료/응급의학` | 응급의학 전문의 | 15년 |
| `의료/외과` | 외과 전문의 | 20년 |
| `법조/형사변호` | 형사전문 변호사 | 18년 |
| `법조/검찰` | 검사 | 17년 |
| `교육/고등학교` | 고등학교 교사 | 22년 |
| `기업/스타트업` | 창업자 겸 CTO | 12년 |

**미등록 도메인**도 일반 템플릿으로 자동 처리됩니다.
예: `"금융/투자은행"`, `"예술/클래식음악"` 등

### Step 1: 실행 (기본)

외부 자료 없이 도메인 키워드만으로 실행:

```bash
cd /Users/gamnamu/Documents/cr-lab-stroytelling/workflow

# 탐사보도 기자 배경 소설
python run.py --input 소재.txt --domain "언론/탐사보도" --interactive

# 응급실 의사 배경 소설
python run.py --input 소재.txt --domain "의료/응급의학" --auto

# 미등록 도메인도 가능
python run.py --input 소재.txt --domain "항공/조종사" --auto
```

### Step 2: 추가 자료로 보강 (선택)

더 구체적인 디테일이 필요한 경우, 추가 자료를 제공할 수 있습니다:

**저장 위치**: `workflow/references/[분야명]/`

```
references/
├── journalism/      ← 언론 분야 추가 자료
├── medicine/        ← 의료 분야 추가 자료
├── law/             ← 법조 분야 추가 자료
└── [새분야]/        ← 필요시 추가
```

**파일 형식**: 마크다운 (`.md`), UTF-8 인코딩

**권장 자료 유형**:

| 유형 | 설명 | 예시 파일명 |
|------|------|------------|
| 용어집 | 전문 용어, 은어, 관용 표현 | `terminology.md` |
| 사례/에피소드 | 실제 있었던 인상적인 사건들 | `famous_cases.md` |
| 내부자 목소리 | 인터뷰, 수기, 에세이 | `insider_stories.md` |

**실행**:

```bash
# 페르소나 기반 + 추가 자료 보강
python run.py --input 소재.txt --domain "언론/탐사보도" --domain-refs references/journalism/ --interactive
```

### 리서처가 제공하는 내용

도메인 학습 모드에서 리서처는 다음 5가지를 제공합니다:

1. **이 세계의 실제 작동 방식**
   - 공식적으로 말하는 것 vs 실제로 작동하는 방식
   - 외부인이 모르는 내부의 규칙과 관행

2. **이 세계의 사람들**
   - 전형적 인물 유형 5-7가지 (동기, 가치관, 내적 갈등 포함)
   - 유형별 특징 (말투, 습관, 사고방식)

3. **드라마의 씨앗들**
   - 구조적 모순에서 비롯되는 딜레마
   - 이 세계에서 자연스럽게 발생하는 갈등 유형

4. **감각적 디테일**
   - 공간, 소리, 시간의 리듬, 은어와 전문용어

5. **클리셰 vs 현실**
   - 대중이 가진 오해나 고정관념
   - 드라마/영화에서 흔히 틀리게 그리는 것

### 결과물

도메인 학습 모드에서는 추가 산출물이 생성됩니다:

```
outputs/
├── 00-domain_knowledge.md  ← 리서처가 제공한 도메인 지식
├── 01-theme.md             ← 이하 기존과 동일
└── ...
```

---

## 6. 프로세스 상세 설명

### 기본/도메인 학습 모드 흐름

```
┌─────────────────────────────────────────────────────────────┐
│  [입력] 소재 텍스트 + 도메인 키워드 + (선택) 추가 자료         │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 0] 리서처 (도메인 모드만)                             │
│  - 페르소나 활성화: 해당 분야 15-20년 베테랑으로 전환          │
│  - LLM 내재 지식에서 내부자만 아는 진실 추출                   │
│  - (선택) 추가 자료로 구체적 사례/용어 보강                    │
│  → 출력: 00-domain_knowledge.md                             │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 1] 철학자                                             │
│  - "이 소재가 던지는 본질적 질문은?"                          │
│  - 화두, 문제의식, 잠재적 갈등 구조 도출                       │
│  → 출력: 01-theme.md                                        │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 2] 소설가 A                                           │
│  - 화두를 담을 그릇 설계                                      │
│  - 인물, 시공간, 플롯 구조 (시놉시스)                          │
│  → 출력: 02-synopsis_v1.md                                  │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 3] 소설가 B                                           │
│  - 시놉시스 구조 비평                                        │
│  - 개연성, 캐릭터 동기, 플롯 논리 검토                         │
│  → 출력: 03-feedback.md                                     │
├─────────────────────────────────────────────────────────────┤
│  ◀ 체크포인트 1: 시놉시스와 피드백 확인                        │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 4] 소설가 A                                           │
│  - 피드백 반영하여 본문 초고 작성                             │
│  - 실제 소설 텍스트 (3,000~5,000자)                          │
│  → 출력: 04-draft_v1.md                                     │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 5] 편집자                                             │
│  - 문장 단위 편집 의견                                       │
│  - 리듬, 간결성, 감각적 표현 개선점                            │
│  → 출력: 05-edit_notes.md                                   │
├─────────────────────────────────────────────────────────────┤
│  ◀ 체크포인트 2: 초고와 편집 의견 확인                         │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 6] 소설가 A                                           │
│  - 편집 의견 반영하여 본문 수정                               │
│  → 출력: 06-draft_v2.md                                     │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 7] 비평가                                             │
│  - 작품의 문학적 의의 해석                                    │
│  - 주제의식, 상징, 승화 방향 제시                              │
│  → 출력: 07-critique.md                                     │
├─────────────────────────────────────────────────────────────┤
│  ◀ 체크포인트 3: 비평 확인                                    │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step 8] 소설가 A                                           │
│  - 비평 반영하여 최종본 완성                                  │
│  → 출력: 08-final.md  ★ 완성!                               │
└─────────────────────────────────────────────────────────────┘
```

### 재작성 모드 흐름

```
┌─────────────────────────────────────────────────────────────┐
│  [입력] 기존 완성본 + 독자 피드백                             │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step R1] 진단자                                            │
│  - 피드백의 표면적 불만 → 실제 문제 진단                       │
│  - 수정 범위 결정 (표면/부분/구조/근본)                        │
│  - 구체적 수정 지시 작성                                      │
│  → 출력: R1-revision_plan.md                                │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step R2] 소설가 A                                          │
│  - 수정 계획에 따라 본문 수정                                 │
│  - 강점 보존, 약점 개선                                       │
│  → 출력: R2-draft_revised.md                                │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step R3] 편집자                                            │
│  - 수정본 검토                                               │
│  - 피드백이 잘 반영되었는지 확인                              │
│  → 출력: R3-edit_notes.md                                   │
├─────────────────────────────────────────────────────────────┤
│  ◀ 체크포인트: 수정본 확인                                    │
└─────────────────────────────────────────────────────────────┘
                              ↓
┌─────────────────────────────────────────────────────────────┐
│  [Step R4] 소설가 A                                          │
│  - 편집 의견 최종 반영                                        │
│  → 출력: revised_final.md  ★ 수정 완료!                     │
└─────────────────────────────────────────────────────────────┘
```

---

## 7. 세션 종료 후 재시작

### 방법 1: 터미널에서 직접 실행 (권장)

Claude Code 없이도 독립적으로 실행할 수 있습니다.

```bash
# 1. 터미널 열기

# 2. 워크플로우 디렉토리로 이동
cd /Users/gamnamu/Documents/cr-lab-stroytelling/workflow

# 3. API 키 설정 (세션마다 필요)
export ANTHROPIC_API_KEY="your-api-key"

# 4. 실행
python run.py --input 소재.txt --interactive
```

### 방법 2: 새 Claude Code 세션에서 실행

새 세션을 열고 다음과 같이 요청:

```
/Users/gamnamu/Documents/cr-lab-stroytelling/workflow 디렉토리에서
run.py를 실행해서 소설 창작을 시작해줘.

소재: [여기에 소재 입력]
```

### 중간 결과물 활용

이전 세션에서 중단된 경우, `outputs/` 폴더의 중간 결과물을 확인할 수 있습니다:

```bash
ls workflow/outputs/
# 01-theme.md, 02-synopsis_v1.md 등 확인
```

### 이전 작업 이어가기

1. **완성본 수정하기**: 재작성 모드 사용
   ```bash
   python run.py --revise outputs/08-final.md --feedback "피드백" --interactive
   ```

2. **처음부터 다시 시작**: 새 소재 파일로 실행
   ```bash
   python run.py --input 새소재.txt --interactive
   ```

---

## 8. 문제 해결

### API 키 오류

```
Error: Could not find API key
```

**해결**: API 키 환경변수 설정
```bash
export ANTHROPIC_API_KEY="your-api-key"
```

### 파일을 찾을 수 없음

```
오류: 파일을 찾을 수 없습니다: 소재.txt
```

**해결**:
1. 현재 디렉토리 확인: `pwd`
2. `workflow/` 디렉토리로 이동: `cd workflow`
3. 파일 존재 확인: `ls *.txt`

### 도메인 키워드 관련

**등록된 도메인 목록 확인**:
```
언론/탐사보도, 언론/방송뉴스
의료/응급의학, 의료/외과
법조/형사변호, 법조/검찰
교육/고등학교, 기업/스타트업
```

**미등록 도메인도 사용 가능**: 일반 템플릿으로 자동 처리됩니다.

### 추가 자료 인식 안 됨

```
추가 자료 0개 로드됨
```

**해결**:
1. 파일 확장자가 `.md`인지 확인
2. 경로가 정확한지 확인: `references/journalism/` (슬래시 포함)
3. 파일이 UTF-8 인코딩인지 확인
4. `--domain-refs` 옵션을 사용했는지 확인

### 중간에 중단된 경우

`outputs/` 폴더에서 마지막으로 생성된 파일 확인 후:
- 완성본이 있으면 → 재작성 모드로 수정
- 없으면 → 처음부터 다시 시작

---

## 부록: 명령어 요약

### 기본 모드
```bash
python run.py --input 소재.txt --interactive    # 대화형
python run.py --input 소재.txt --auto           # 자동
python run.py --input-text "소재" --auto        # 직접 입력
```

### 도메인 학습 모드 (페르소나 기반)
```bash
# 기본: 도메인 키워드만으로 실행
python run.py --input 소재.txt --domain "언론/탐사보도" --interactive
python run.py --input 소재.txt --domain "의료/응급의학" --auto

# 미등록 도메인도 가능
python run.py --input 소재.txt --domain "금융/투자은행" --auto

# 추가 자료 보강
python run.py --input 소재.txt --domain "언론/탐사보도" --domain-refs references/journalism/ --interactive
```

### 재작성 모드
```bash
python run.py --revise outputs/08-final.md --feedback "피드백" --interactive
python run.py --revise outputs/08-final.md --feedback-file feedback.txt --auto
```

### 도움말
```bash
python run.py --help
```

---

## 부록: 파일 위치 요약

| 용도 | 위치 |
|------|------|
| 소재 파일 | `workflow/소재.txt` |
| 도메인 자료 | `workflow/references/[분야명]/*.md` |
| 피드백 파일 | `workflow/feedback.txt` |
| 결과물 | `workflow/outputs/` |
| 최종 완성본 | `workflow/outputs/08-final.md` |
| 수정 완성본 | `workflow/outputs/revised_final.md` |
| 실행 로그 | `workflow/logs/` |

---

*이 가이드에 대한 질문이나 개선 제안은 언제든 환영합니다.*
